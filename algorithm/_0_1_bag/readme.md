# 0-1背包问题

## 问题描述

总共有三件物品，背包可容纳5磅的东西，物品1重1磅，价值60元。物品2重2磅，价值100元，物品3重3磅，价值120元。怎么才能最大化背包所装物品的价值。

## 分析解答

此题无法使用贪心算法求解，因为使用贪心策略时，首先会计算计算每个商品的每磅价值（价值/重量），即为k,然后依次将k值最大的首先放入包裹，因此对于上述问题，此策略将无法得到最优解。贪心算法适合与分数（部分）背包问题，即物品可以被分为更小的部分，然后一次取走k最大的部分。可以把0-1背包问题的一件物品想象成一个金锭，而部分问题中的一件物品则更像金沙。

0-1背包问题有两种情况，一种是物品有限的情况，如上述问题，还有一种为物品无限的情况。首先求解物品有限的情况。

### 物品数量有限

我们可以利用动态规划来解0-1背包问题。

假设 $w[i]$ 表示第 $i$ 件物品的重量，$v[i]$ 表示第i件物品的价值，$dp[i][j]$ 表示背包容量为 $j$ ,可选物品为物品 $1~i$ 时，背包能获得的最大价值。

用动态规划求解即先求出背包容量较小时能获得的最大价值，然后根据背包容量较小时的结果求出背包容量较大时的结果，也就是一个递推的填表过程。当没有可选物品时，背包能获得的最大价值为0。即表格可初始化为

| 物品/背包重量(j)   | 0     | 1     | 2     | 3     | 4     | 5     |
| :--------------: | :---: | :---: | :---: | :---: | :---: | :---: |
| 0                | 0     | 0     | 0     | 0     | 0     | 0     |
| 1                | ...   | ...   | ...   | ...   | ...   | ...   |
| 2                | ...   | ...   | ...   | ...   | ...   | ...   |
| 3                | ...   | ...   | ...   | ...   | ...   | ...   |

填表过程（即状态转移方程）是：

$$ dp[i][j] = \begin{cases}
    & dp[i - 1][j] & j < w[i] \\
    & max(dp[i - 1][j], dp[i - 1][j - w[i]] + v[i])  & j \ge w[i]
\end{cases} $$

$j < w[i]$ 表示第 $i$ 件物品的重量大于当前背包的容量 $j$，此时显然不放第 $i$ 件物品。下面解释上述方程在“其它“情况下的意义：”将前$i$件物品放入容量为 $j$ 背包中“这个问题，如果只考虑第 $i$ 件物品放或者不放，那么就可以转化为只涉及前 $i-1$ 件物品的问题，即：

1. 如果不放第i件物品，则问题转化为只涉及”前 $i-1$ 件物品放入容量为 $j$ 的背包中“

2. 如果放第 $i$ 件物品，则问题转化为”前 $i-1$ 件物品放入剩下的容量为 $j-w[i]$ 的背包中“，此时能获得的最大价值就是 $dp[i-1][j-w[i]]$ 再加上通过放入第 $i$ 件物品获得的价值 $v[i]$。
3. $dp[i][j]$ 就是1、2中最大的那个值。

显然，可以从左下角利用状态转移方程依次逐行填表，得到 $dp[3][5]$ （表示可选物品为1、2、3，且背包容量为5时，能获得的最大价值），可见动态规划的确即为一个递推的过程。填表后如下表所示：

| 物品/背包重量(j)   | 0     | 1     | 2     | 3     | 4     | 5     |
| :--------------: | :---: | :---: | :---: | :---: | :---: | :---: |
| 0                | 0     | 0     | 0     | 0     | 0     | 0     |
| 1                | 0     | 60    | 60    | 60    | 60    | 60    |
| 2                | 0     | 60    | 100   | 160   | 160   | 160   |
| 3                | 0     | 60    | 100   | 160   | 180   | 220   |

### 物品数量无限（完全背包）

问题解法思路跟上述基本相同，只是在考虑第 $i$ 个物品是否放入背包的时候，此时背包可能已经放入该物品。地推公式如下：

$$ dp[i][j] = \begin{cases}
    & dp[i - 1][j] & j < w[i] \\
    & max(dp[i - 1][j], dp[i][j - w[i]] + v[i])  & j \ge w[i]
\end{cases} $$
